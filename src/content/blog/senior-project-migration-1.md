---
title: 노인복지관 프로젝트 문제점과 개선 계획
excerpt: 기존 프로젝트 구조와 배포 방식의 문제점을 정리하고, 개선을 위한 계획을 세워보겠습니다.
publishDate: 'Mar 29 2024'
tags:
  - 노인복지관
seo:
  image:
    src: '/post-2.jpg'
    alt: 노인복지관 프로젝트 migration 배경과 계획
---

작년 11월에 개발하기 시작한 노인복지관 프로젝트와 관련해서 그동안 많은 일들이 있었지만 글로 정리한 적이 없었습니다. 프로젝트 개편을 앞두고 있는 현재, 처음부터 풀스택 개발을 혼자 하면서 느꼈던 불편한 부분들을 정리하고 앞으로 어떤 방향으로 개선해 나갈지 계획을 세우고 글로 남겨볼까 합니다.

## 단일 레포 구조 도입 목적

처음 프로젝트를 시작할 때, 프론트엔드와 백엔드를 분리하지 않고 하나의 Github Repo에 구성했습니다. 개인 프로젝트이기 때문에 처음부터 완벽한 구조를 갖추기보다는 빠르게 개발을 진행하고 싶었던 마음이 컸습니다.

1.  MERN 스택을 사용하면서 프론트엔드와 백엔드를 분리하지 않고 하나의 레포지토리로 개발해서 개발 속도를 높인다.
2.  프로젝트 배포시 서버와 클라이언트를 함께 배포해서 배포에 드는 리소스를 줄인다.

하지만 1차 배포가 끝나고, 유지보수 기간에 들어서면서 단일 레포 구조의 단점이 더욱 크게 느껴지기 시작했습니다.

## 장점이 장점이 아니었다.

<img width="790" alt="노인복지관 기존 구조" src="../../../public/노인복지관 기존 구조.png">

이미지를 보면 정말 많은 문제점들이 눈에 띕니다. 하나씩 살펴보겠습니다.

### 시간이 흐를수록 개발 속도가 느려진다.

프로젝트 초반에는 개발속도가 정말 빨랐습니다. 혼자 로컬에서 프론트엔드와 백엔드를 동시에 개발하고 작업이 완료되면 변경된 결과물을 기록을 위해 github main branch에 push하고, 배포는 로컬에서 수동으로 진행했습니다.

```bash
// local CLI command
docker build . --platform linux/amd64 -t [프로젝트 이름]
docker push [프로젝트 이름]
cd
cd 노인복지관
ssh -i [key.pem] ec2-user@[ec2 public ip]

// ec2 CLI command
docker stop [프로젝트 이름]
docker rm [프로젝트 이름]
docker pull [프로젝트 이름]
docker run -d -p 80:80 [프로젝트 이름]
```

이렇게 진행하다보니, 시간이 흐를수록 로컬에서 작업한 내용을 ec2에 배포하는 과정이 번거로워졌습니다. 배포가 오래걸리기도 했고, ec2에 배포하는 과정에서 오류가 발생하면 디버깅하기도 어려워서 수없이 낑낑거리며 시간을 보낸 기억이 있습니다. 그리고 위 command를 보면, 배포를 하기 위해서 수동으로 docker를 stop하고 rm는 과정이 있는데, 이로 인해 배포 중간에 서비스 중단 시간이 길어지는 문제도 있었습니다.

그리고 제일 큰 문제는, 클라이언트 프로젝트 빌드 결과물을 서버 프로젝트 루트 디렉토리에 넣어서 단일 docker image를 ec2에서 실행하는 배포 방식이었습니다. 초기에 인프라 지식이 없어서 최대한 간단하고 빠르게 적용할 수 있는 방식을 적용한 것인데.. 너무 큰 패착이었습니다.

1. 클라이언트 프로젝트의 변경사항이 있을 때마다 서버 프로젝트도 함께 빌드하고 배포해야 했습니다. 그래서 당연하게도 서버 프로젝트의 빌드 시간이 늘어나고, 서버 프로젝트의 빌드 결과물이 커지는 문제가 있었습니다.
2. 비슷한 맥락으로 서버 프로젝트의 변경사항이 있을 때마다 클라이언트 프로젝트도 함께 중단 후 배포되어서 서비스가 중단되는 문제가 있었습니다.(무중단 배포가 아닌 이상 당연한 현상일까요..?)

### 단일 레포, 단일 브랜치 관리의 장점을 못 살린다.

단일 레포에 MERN 스택 프로젝트를 구성하면서 초기에는 개발 속도가 정말 빨랐습니다. React, Node.js, Express.js 모두 JavaScript 기반이어서, 백엔드 관련 지식이 거의 없는 상태에서 학습 후 백엔드 개발을 하기에 러닝 커브가 다른 스택들에 비해서 높지 않아 비교적 수월했습니다.

그리고 개발 외적으로 추가 리소스를 사용하지 않고 개발을 진행할 수 있었습니다. git 전략, 코드 리뷰, 브랜치 전략 등 을 고민할 필요가 없었고, 그래서 프론트엔드를 개발하다가 백엔드 개발로 넘어갈 때 branch를 변경하는 등 추가 작업이 없었습니다.

하지만 시간이 흐를수록, 어쩌면 당연하게도 위 장점들은 장점이 아니었습니다. 코드의 품질도 나빠지고, 얕게 학습하고 백엔드 구성을 했기 때문에 보안 문제나 성능 이슈 등이 발생했을 때 대처하기가 어려웠습니다. git 전략이나 브랜치 전략도 없었기 때문에, 추후 프로젝트 유지 보수 기간에 버전 관리나 과거 버전의 코드를 참고하기도 어려웠습니다.

여기에 초기에는 생각하지 못했던 지점인데, 단일 레포에서 JS 기반의 MERN 스택을 사용했을 때, 각 프로젝트에 공통으로 사용되는 로직들, 예를 들어서 util 함수나 상수, TS를 사용한다면 타입 정의 파일 등을 공통으로 관리할 수 있는 단일 레포 관리의 장점을 살리지 못하고 있었습니다.

## 앞으로의 계획

우선 목표를 정했습니다.

--- 초안 작성 중입니다. ---

1.
2.

<img width="790" alt="노인복지관 기존 구조" src="../../../public/노인복지관 예상 구조.png">

## 참고
